# CryptoChallengelab11
Secure Communications and Cryptography Challenge Lab 11

# Ciphertext Decoder: decrypt.py

This utility is a Python script designed to decrypt a multi-layered ciphertext generated by a recovered encryption program. The encryption scheme uses a sequence of three different steps, each indicated by a leading numerical prefix in the resulting ciphertext.

## Usage

### Prerequisites

* Python 3

### Running the Script

1.  Execute the script from your terminal:
    ```bash
    python decrypt.py
    ```
2.  The script will prompt you to paste the intercepted ciphertext:
    ```
    Paste the intercepted ciphertext (single line), then press Enter:
    ```
3.  Paste the ciphertext and press Enter to view the recovered plaintext.

## Decryption Logic (The `decrypt` function)

The decryption process is based on **peeling** back the layers of encryption, where each layer is identified by a single-digit prefix ('1', '2', or '3').

### Encryption/Decryption Steps

The full decryption involves reversing a sequence of the following three steps:

| Step Prefix | Operation Type | Inverse Function | Details |
| :---: | :--- | :--- | :--- |
| `1` | **Substitution Cipher** | `inv_step1` | A fixed, complex monoalphabetic substitution. |
| `2` | **Base64 Encoding** | `inv_step2` | Standard Base64 decoding. |
| `3` | **Caesar Cipher** | `inv_step3` | A ROT-4 (shift-by-4) Caesar cipher, applied only to lowercase letters. |

### Process Flow

1.  **Peeling Loop:** The script repeatedly checks the first character of the input. If it is '1', '2', or '3', the prefix is removed, and the corresponding inverse function (`inv_step1`, `inv_step2`, or `inv_step3`) is applied to the remainder of the string.
2.  **Final Payload:** After all prefixed layers are removed, the resulting string is inspected.
    * If it starts with `'2'`, the rest of the string is treated as a final Base64-encoded payload and decoded one last time.
    * Otherwise, the resulting string is considered the final plaintext.

## Example (Reverse-Engineered Encryption)

Based on the decryption logic, a message is encrypted by applying the steps in reverse order of decryption, where each step prepends its indicator:

| Action | Example Input | Result |
| :--- | :--- | :--- |
| **Start** | `plaintext` | `plaintext` |
| **Step 3 (ROT-4)** | `plaintext` | `3 + output_of_step3` |
| **Step 1 (Substitution)** | `3 + output_of_step3` | `1 + output_of_step1` |
| **Step 2 (Base64)** | `1 + output_of_step1` | `2 + output_of_step2` |
| **Final Ciphertext** | | `213plaintext_ciphertext` |
